function JSSerializer(){this.Data=null,this.Serialize=function(e){return!!c("SrliZe",e)&&(this.Data=new l("SrliZe",e,null),n(e,this.Data),!0)},this.HasData=function(){return!!this.Data},this.MaxDepth=null,this.CheckInfiniteLoops=!0;var s=this,i=0;function n(e,t){if(i++,null==s.MaxDepth||""==s.MaxDepth||s.MaxDepth<0||i<=s.MaxDepth){var r=!1;try{for(n in e)a(n,e,t),r=!0}catch(e){}if(!r&&e&&e.length&&"Object"==o(e))for(var n=0;n<e.length;n++)a(n,e,t)}i--}function a(e,t,r){c(e,t[e])&&(objSerial=new l(e,t[e],r),r.Kids[r.Kids.length]=objSerial,s.CheckInfiniteLoops&&(objSerial.RealObject=t[e],objSerial.Link=function(e){var t=e;blnDidCheck=!1;try{for(;null!=t.Parent&&t.Parent.RealObject!=e.RealObject;)blnDidCheck=!0,t=t.Parent}catch(e){return null}return blnDidCheck?t.Parent:null}(objSerial)),u(t[e])&&null==objSerial.Link&&n(t[e],objSerial))}function o(e){try{var t;return e.constructor?(""==(t=e.constructor.toString().match(/function (\w*)/)[1]).replace(" ","")&&(t="n/a"),!s.Types.UseObjectsForUserDefined||t in function(e){for(var t={},r=0;r<e.length;r++)t[e[r]]="";return t}(["Array","Boolean","Date","Enumerator","Error","Function","Number","RegExp","String","VBArray"])||(t="Object"),t):"n/a"}catch(e){return"n/a"}}function u(e){try{return"Boolean"!=o(e)&&"Date"!=o(e)&&"Enumerator"!=o(e)&&"Function"!=o(e)&&"Number"!=o(e)&&"RegExp"!=o(e)&&"String"!=o(e)&&"VBArray"!=o(e)&&null!=o(e)&&void 0!==o(e)}catch(e){return!1}}function c(e,t){try{switch(o(t)){case"n/a":return null==t?s.Types.UseUndefined:s.Types.UseNull;case"Array":return s.Types.UseArray;case"Object":return s.Types.UseObject;case"Boolean":return s.Types.UseBoolean;case"Date":return s.Types.UseDate;case"Enumerator":return!1;case"Error":return s.Types.UseError;case"Function":return"constructor"!=e&&s.Types.UseFunction;case"Number":return s.Types.UseNumber;case"RegExp":return s.Types.UseRegExp;case"String":return s.Types.UseString;case"VBArray":return!1;default:return s.Types.UseUserDefined}}catch(e){return!1}}function l(e,t,r){if(this.Name=e,null!=t)try{t.toString&&(this.Value=t.toString())}catch(e){}else this.Value=t;this.RealObject=null,this.Type=typeof t,this.ExactType=o(t),this.IsContainer=u(t),this.Parent=r,this.Kids=new Array,this.Link=null}}function SerialPrefs(){this.ShowLineBreaks=!1,this.SmartIndent=!1,this.ShowTypes=!1}function SerialTypes(){this.UseNull=!0,this.UseUndefined=!0,this.UseArray=!0,this.UseObject=!0,this.UseBoolean=!0,this.UseDate=!0,this.UseError=!0,this.UseFunction=!0,this.UseNumber=!0,this.UseRegExp=!0,this.UseString=!0,this.UseUserDefined=!0,this.UseObjectsForUserDefined=!1}JSSerializer.prototype.Prefs=new SerialPrefs,JSSerializer.prototype.Types=new SerialTypes;